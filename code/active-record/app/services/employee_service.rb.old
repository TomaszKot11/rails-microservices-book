#require_relative '../lib/employee_message.pb'
#puts "EmployeeMessageService: #{EmployeeMessageService.inspect}"
class EmployeeService < ::Protobuf::Rpc::Service #RPCService
  def search(request)
    #puts "received request: #{request.inspect}"
    #byebug
    #records = ::Employee.where(guid: request.guid).to_a
      #.or(::Employee.where(first_name: request.first_name))
      #.or(::Employee.where(last_name: request.last_name))
    puts "::Employee.by_fields(request):"
    puts ::Employee.by_fields(request).inspect
    records = ::Employee.by_fields(request)#.map(&:to_proto)
    byebug
    respond_with records: records
  end

  #def create(request)
  def create()
    record = ::Employee.create(request)

    respond_with record
  end

  def update(request)
    record = ::Employee.where(guid: request.guid).update_attributes(request)

    respond_with record
  end

  def delete(request)
    record = ::Employee.where(guid: request.guid).delete_all

    respond_with record
  end
end
